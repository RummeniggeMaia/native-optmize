$(document).ready(function () {
    url = 'http://localhost/native-optimize/public/api';
    // url = 'https://app.ads4xxx.com/api';
    wg = $('#nativeop51-list').data('wg');
    if (wg === null) {
        console.log('Native Optimize: Widget n√£o encontrado no corpo do site.');
        return;
    }
    var cont = Cookies.get('nativeop51');
	if (cont) {
		cont++;
	} else {
		cont = 1;
	}
	var date = new Date();
	date.setTime(date.getTime() + (60 * 60 * 1000));
	Cookies.set('nativeop51', 1, {expires: date, path: '/'});
    $.ajax({
        dataType: "json",
        accepts: "application/json",
        method: 'GET',
        url: url + '/random_creatives?wg=' + wg + '&cont=' + cont
    }).done(function (x) {
        con = $('<div>');
        ul = $('<ul>').css({
            'list-style-type': 'none',
            'margin': 0,
            'padding': 0,
            'overflow': 'hidden'
        });
        $.each(x[1], function (i, v) {
            a = $('<a>', {
                title: '',
                href: url + '/clicks?click_id=' + v.click_id + '&ct=' + v.hashid + '&wg=' + wg + '&cp=' + v.campaign_id,
                target: '_blank',
            }).css({
                'color': x[0].title_color,
                'text-decoration': 'none',
                'font-weight': 'bold',
            }).hover(function () {
                $(this).css({
                    'color': x[0].title_hover_color
                });
            }, function () {
                $(this).css({
                    'color': x[0].title_color
                });
            });
            img = $('<img>', {
                src: v.image,
                width: x[0].image_width,
                height: x[0].image_height
            });
            let card = $('<div>', {
                class: 'card',
            }).css({
                'width': '15rem',
                'margin-right': '10px',
                'background-color': x[0].card_body_color
            });
            let cardBody = $('<div>', {
                class: 'card-body'
            });
            let title = $('<h4>', {
                class: 'card-title'
            })
            let brand = $('<p>', {
                text: v.brand,
                class: 'card-text',
            }).css({
                'color' : 'white',
                'text-align' : 'justify'
            });
            title.append(a.append(v.name));
            cardBody.append(title);
            cardBody.append(brand);
            card.append(img);
            card.append(cardBody);
            ul.append($('<li>').css({'float': 'left'}).append(card));
        });
        con.append(ul);
        $('#nativeop51-list').append(con);
    }).fail(function () {
        console.log('Native Optimize: Widget nao encontrado no sistema.');
    });
});